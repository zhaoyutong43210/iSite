(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24643,        589]
NotebookOptionsPosition[     23230,        558]
NotebookOutlinePosition[     23617,        575]
CellTagsIndexPosition[     23574,        572]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Z1", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    FractionBox["L1", "w"], " ", "w1box"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{"1", "/", "Z1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d1", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S21", " ", "=", 
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"a1", "+", 
      RowBox[{"b1", "/", "z0"}], "+", 
      RowBox[{"c1", "*", "z0"}], "+", "d1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kext1", " ", "=", " ", 
   FormBox[
    FractionBox["z0", 
     RowBox[{"2", " ", "L1"}]],
    TraditionalForm]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"result", " ", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"S21", "-", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A1", "=", 
   FractionBox[
    RowBox[{" ", 
     RowBox[{"w", " ", "kext1", " "}]}], 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "w1box"}], " ", "-", "  ", 
     RowBox[{"w", "  ", "kext1", " "}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"result", "-", "A1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.799412582586652*^9, 3.7994126181129017`*^9}, {
  3.79941265066576*^9, 3.7994126540277443`*^9}, {3.7994127234583855`*^9, 
  3.7994127393951664`*^9}, {3.7994151507401037`*^9, 3.7994151671518683`*^9}},
 CellLabel->
  "In[2329]:=",ExpressionUUID->"ccc0459f-bd19-4de9-b159-6c9df19899a0"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.799412698463722*^9, 3.799412741648328*^9}, 
   3.79941285869497*^9, {3.7994129140511045`*^9, 3.799412962812795*^9}, 
   3.799413223636778*^9, {3.7994133179904256`*^9, 3.799413382029249*^9}, {
   3.7994135737565804`*^9, 3.7994135805392575`*^9}, 3.7994136269383993`*^9, 
   3.7994136735736113`*^9, 3.799413864162675*^9, {3.79941392062101*^9, 
   3.7994139438389177`*^9}, {3.7994140466547956`*^9, 
   3.7994140565624437`*^9}, {3.799414107327526*^9, 3.7994141292660203`*^9}, 
   3.7994143606499233`*^9, {3.7994143996131363`*^9, 3.799414405087347*^9}, {
   3.7994144518977733`*^9, 3.79941446967822*^9}, 3.7994145061196437`*^9, {
   3.7994145395794306`*^9, 3.7994145492148905`*^9}, 3.7994145925443277`*^9, 
   3.799414888271818*^9, 3.7994150347833967`*^9, 3.799415098882778*^9, {
   3.7994151707615833`*^9, 3.7994152135053124`*^9}, 3.799415252216339*^9, {
   3.7994153108504343`*^9, 3.799415340076357*^9}, {3.799415424777079*^9, 
   3.799415493800338*^9}, {3.799415558156002*^9, 3.799415570887694*^9}, {
   3.7994156047982163`*^9, 3.7994156198939815`*^9}, 3.7994281039831*^9, 
   3.799432143392589*^9},
 CellLabel->
  "Out[2338]=",ExpressionUUID->"8dfe318b-050e-434a-a930-f64030e6cdbd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Z2", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    FractionBox["L2", "w"], " ", "w2box"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2", "=", 
   RowBox[{"1", "/", "Z2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d2", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kext2", " ", "=", " ", 
   FormBox[
    FractionBox["z0", 
     RowBox[{"2", " ", "L2"}]],
    TraditionalForm]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Phase", " ", "=", "kl"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1", ",", "b1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", "d1"}], "}"}]}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "Phase", "]"}], ",", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "z0", "*", 
        RowBox[{"Sin", "[", "Phase", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "I"}], "/", "z0"}], "*", 
        RowBox[{"Sin", "[", "Phase", "]"}]}], ",", 
       RowBox[{"Cos", "[", "Phase", "]"}]}], "}"}]}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M3", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a2", ",", "b2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", "d2"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M", " ", "=", " ", 
    RowBox[{"M1", ".", " ", "M2", ".", "M3"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "M1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "M2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "M3", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "M", "]"}]}], "Input",
 CellChangeTimes->{{3.799412758409913*^9, 3.7994127846807375`*^9}, {
  3.799415145796386*^9, 3.799415145798386*^9}},
 CellLabel->
  "In[2339]:=",ExpressionUUID->"a4eacfae-18cb-4f24-b339-afa419c95482"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "w"}], 
       RowBox[{"L1", " ", "w1box"}]], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7994127959454317`*^9, 3.7994128587539787`*^9, {3.799412914084076*^9, 
   3.799412962845825*^9}, 3.7994132236728115`*^9, {3.7994133180217123`*^9, 
   3.799413382060529*^9}, {3.799413573786604*^9, 3.7994135805702925`*^9}, 
   3.7994136269683743`*^9, 3.799413673606607*^9, 3.7994138641939344`*^9, {
   3.799413920640492*^9, 3.7994139438701706`*^9}, {3.7994140467037964`*^9, 
   3.7994140566114492`*^9}, {3.7994141073574996`*^9, 3.79941412930905*^9}, 
   3.79941436068122*^9, {3.7994143996443605`*^9, 3.799414405118595*^9}, {
   3.799414451929019*^9, 3.79941446970722*^9}, 3.799414506166651*^9, {
   3.7994145396263123`*^9, 3.7994145492461634`*^9}, 3.799414592599332*^9, 
   3.799414888335133*^9, 3.799415034807398*^9, 3.7994150989157443`*^9, {
   3.7994151708046136`*^9, 3.799415213534339*^9}, 3.7994152522463765`*^9, {
   3.7994153109004364`*^9, 3.799415340100357*^9}, {3.799415424823078*^9, 
   3.7994154938313417`*^9}, {3.7994155581880026`*^9, 
   3.7994155709206934`*^9}, {3.799415604830211*^9, 3.799415619918951*^9}, 
   3.7994281040143785`*^9, 3.7994321434394655`*^9},
 CellLabel->
  "Out[2350]//MatrixForm=",ExpressionUUID->"8dfd3343-d444-42a8-9d28-\
486643d19c3f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "kl", "]"}], 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "z0", " ", 
       RowBox[{"Sin", "[", "kl", "]"}]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"Sin", "[", "kl", "]"}]}], "z0"]}], 
      RowBox[{"Cos", "[", "kl", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7994127959454317`*^9, 3.7994128587539787`*^9, {3.799412914084076*^9, 
   3.799412962845825*^9}, 3.7994132236728115`*^9, {3.7994133180217123`*^9, 
   3.799413382060529*^9}, {3.799413573786604*^9, 3.7994135805702925`*^9}, 
   3.7994136269683743`*^9, 3.799413673606607*^9, 3.7994138641939344`*^9, {
   3.799413920640492*^9, 3.7994139438701706`*^9}, {3.7994140467037964`*^9, 
   3.7994140566114492`*^9}, {3.7994141073574996`*^9, 3.79941412930905*^9}, 
   3.79941436068122*^9, {3.7994143996443605`*^9, 3.799414405118595*^9}, {
   3.799414451929019*^9, 3.79941446970722*^9}, 3.799414506166651*^9, {
   3.7994145396263123`*^9, 3.7994145492461634`*^9}, 3.799414592599332*^9, 
   3.799414888335133*^9, 3.799415034807398*^9, 3.7994150989157443`*^9, {
   3.7994151708046136`*^9, 3.799415213534339*^9}, 3.7994152522463765`*^9, {
   3.7994153109004364`*^9, 3.799415340100357*^9}, {3.799415424823078*^9, 
   3.7994154938313417`*^9}, {3.7994155581880026`*^9, 
   3.7994155709206934`*^9}, {3.799415604830211*^9, 3.799415619918951*^9}, 
   3.7994281040143785`*^9, 3.7994321434394655`*^9},
 CellLabel->
  "Out[2351]//MatrixForm=",ExpressionUUID->"ae586f66-88dd-4f90-82da-\
da21debb2c17"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "w"}], 
       RowBox[{"L2", " ", "w2box"}]], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7994127959454317`*^9, 3.7994128587539787`*^9, {3.799412914084076*^9, 
   3.799412962845825*^9}, 3.7994132236728115`*^9, {3.7994133180217123`*^9, 
   3.799413382060529*^9}, {3.799413573786604*^9, 3.7994135805702925`*^9}, 
   3.7994136269683743`*^9, 3.799413673606607*^9, 3.7994138641939344`*^9, {
   3.799413920640492*^9, 3.7994139438701706`*^9}, {3.7994140467037964`*^9, 
   3.7994140566114492`*^9}, {3.7994141073574996`*^9, 3.79941412930905*^9}, 
   3.79941436068122*^9, {3.7994143996443605`*^9, 3.799414405118595*^9}, {
   3.799414451929019*^9, 3.79941446970722*^9}, 3.799414506166651*^9, {
   3.7994145396263123`*^9, 3.7994145492461634`*^9}, 3.799414592599332*^9, 
   3.799414888335133*^9, 3.799415034807398*^9, 3.7994150989157443`*^9, {
   3.7994151708046136`*^9, 3.799415213534339*^9}, 3.7994152522463765`*^9, {
   3.7994153109004364`*^9, 3.799415340100357*^9}, {3.799415424823078*^9, 
   3.7994154938313417`*^9}, {3.7994155581880026`*^9, 
   3.7994155709206934`*^9}, {3.799415604830211*^9, 3.799415619918951*^9}, 
   3.7994281040143785`*^9, 3.799432143455104*^9},
 CellLabel->
  "Out[2352]//MatrixForm=",ExpressionUUID->"3649e641-c116-4763-a945-\
7f274cb5496b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Cos", "[", "kl", "]"}], "+", 
       FractionBox[
        RowBox[{"w", " ", "z0", " ", 
         RowBox[{"Sin", "[", "kl", "]"}]}], 
        RowBox[{"L2", " ", "w2box"}]]}], 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "z0", " ", 
       RowBox[{"Sin", "[", "kl", "]"}]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "w", " ", 
         RowBox[{"Cos", "[", "kl", "]"}]}], 
        RowBox[{"L1", " ", "w1box"}]], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"Sin", "[", "kl", "]"}]}], "z0"], "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "kl", "]"}], "+", 
           FractionBox[
            RowBox[{"w", " ", "z0", " ", 
             RowBox[{"Sin", "[", "kl", "]"}]}], 
            RowBox[{"L1", " ", "w1box"}]]}], ")"}]}], 
        RowBox[{"L2", " ", "w2box"}]]}], 
      RowBox[{
       RowBox[{"Cos", "[", "kl", "]"}], "+", 
       FractionBox[
        RowBox[{"w", " ", "z0", " ", 
         RowBox[{"Sin", "[", "kl", "]"}]}], 
        RowBox[{"L1", " ", "w1box"}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7994127959454317`*^9, 3.7994128587539787`*^9, {3.799412914084076*^9, 
   3.799412962845825*^9}, 3.7994132236728115`*^9, {3.7994133180217123`*^9, 
   3.799413382060529*^9}, {3.799413573786604*^9, 3.7994135805702925`*^9}, 
   3.7994136269683743`*^9, 3.799413673606607*^9, 3.7994138641939344`*^9, {
   3.799413920640492*^9, 3.7994139438701706`*^9}, {3.7994140467037964`*^9, 
   3.7994140566114492`*^9}, {3.7994141073574996`*^9, 3.79941412930905*^9}, 
   3.79941436068122*^9, {3.7994143996443605`*^9, 3.799414405118595*^9}, {
   3.799414451929019*^9, 3.79941446970722*^9}, 3.799414506166651*^9, {
   3.7994145396263123`*^9, 3.7994145492461634`*^9}, 3.799414592599332*^9, 
   3.799414888335133*^9, 3.799415034807398*^9, 3.7994150989157443`*^9, {
   3.7994151708046136`*^9, 3.799415213534339*^9}, 3.7994152522463765`*^9, {
   3.7994153109004364`*^9, 3.799415340100357*^9}, {3.799415424823078*^9, 
   3.7994154938313417`*^9}, {3.7994155581880026`*^9, 
   3.7994155709206934`*^9}, {3.799415604830211*^9, 3.799415619918951*^9}, 
   3.7994281040143785`*^9, 3.799432143455104*^9},
 CellLabel->
  "Out[2353]//MatrixForm=",ExpressionUUID->"1988fcab-b643-46ed-a117-\
f627abd2dc3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"a3", " ", "=", " ", 
   RowBox[{"Part", "[", 
    RowBox[{"M", ",", "1", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b3", " ", "=", " ", 
   RowBox[{"Part", "[", 
    RowBox[{"M", ",", "1", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c3", " ", "=", " ", 
   RowBox[{"Part", "[", 
    RowBox[{"M", ",", "2", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d3", " ", "=", " ", 
   RowBox[{"Part", "[", 
    RowBox[{"M", ",", "2", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S12Coupling", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"2", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a3", "*", "d3"}], "-", 
        RowBox[{"b3", "*", "c3"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"a3", "+", 
        RowBox[{"b3", "/", "z0"}], "+", 
        RowBox[{"c3", "*", "z0"}], "+", "d3"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"S21Coupling", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{"a3", "+", 
      RowBox[{"b3", "/", "z0"}], "+", 
      RowBox[{"c3", "*", "z0"}], "+", "d3"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"S21Coupling", "-", "S12Coupling"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S21pi", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"S21Coupling", " ", "-", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S21pical", "=", " ", 
   FractionBox[
    RowBox[{" ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "kl"}]], "-", "1"}], ")"}], "w1box"}],
       " ", "+", 
      RowBox[{"\[ImaginaryI]", " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         FormBox[
          FractionBox[
           RowBox[{"  ", 
            RowBox[{"kext2", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "kl"}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "w1box"}], "  ", "+", 
               RowBox[{"\[ImaginaryI]", " ", "w", " ", "kext1", "  ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryI]", " ", "kl"}]]}]}], ")"}]}]}], 
           RowBox[{"w2box", "+", 
            RowBox[{"\[ImaginaryI]", " ", "kext2", " ", "w"}]}]],
          TraditionalForm], "-", " ", "kext1"}], ")"}], " "}]}]}], 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{"w1box", "+", 
       RowBox[{"\[ImaginaryI]", " ", "w", " ", "kext1"}]}], " ", ")"}], " ", 
     "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "kl"}]], " ", 
      SuperscriptBox["w", "2"], " ", "kext1", " ", "kext2", 
      RowBox[{"(", 
       FractionBox["1", 
        RowBox[{"w2box", "+", 
         RowBox[{"\[ImaginaryI]", " ", "kext2", " ", "w"}]}]], ")"}]}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"S21pi", "-", "S21pical"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7994128058221135`*^9, 3.7994128358458595`*^9}, {
  3.799412888122095*^9, 3.7994129608187304`*^9}, {3.7994131874781675`*^9, 
  3.7994132197314906`*^9}, {3.7994132544078465`*^9, 3.7994132904271154`*^9}, {
  3.799413332221402*^9, 3.7994133418531895`*^9}, {3.799413556498396*^9, 
  3.7994136256538734`*^9}, {3.7994138570842648`*^9, 3.7994139353169785`*^9}, {
  3.7994140371924615`*^9, 3.799414123534357*^9}, {3.799414331773608*^9, 
  3.799414358596994*^9}, {3.7994143933758764`*^9, 3.799414396704354*^9}, {
  3.7994144493780146`*^9, 3.799414462677687*^9}, {3.7994144976458936`*^9, 
  3.79941459011526*^9}, {3.7994148482599525`*^9, 3.7994148853124905`*^9}, {
  3.799415093359271*^9, 3.799415095778026*^9}, {3.7994151830699215`*^9, 
  3.7994153451328106`*^9}, {3.7994154186561947`*^9, 3.7994154778686767`*^9}, {
  3.7994155432672043`*^9, 3.7994156023648043`*^9}, {3.799428087655485*^9, 
  3.7994281009136267`*^9}},
 CellLabel->
  "In[2354]:=",ExpressionUUID->"992fb974-e434-45d5-a462-bf28b7fc4f94"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "kl"}]], " ", "L1", " ", "L2", " ", "w1box",
    " ", "w2box"}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "kl"}]], " ", 
    SuperscriptBox["w", "2"], " ", 
    SuperscriptBox["z0", "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "L1", " ", "w1box"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "w", " ", "z0"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "L2", " ", "w2box"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "w", " ", "z0"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.7994128591089506`*^9, {3.799412914114109*^9, 3.7994129628748245`*^9}, 
   3.799413223702812*^9, {3.7994133180529337`*^9, 3.7994133820917816`*^9}, {
   3.799413573816606*^9, 3.7994135806002965`*^9}, 3.79941362699641*^9, 
   3.7994136736353264`*^9, 3.7994138642095256`*^9, {3.799413920671749*^9, 
   3.7994139439001207`*^9}, {3.799414046731799*^9, 3.7994140566394463`*^9}, {
   3.799414107385496*^9, 3.7994141293370514`*^9}, 3.7994143606968083`*^9, {
   3.7994143996613684`*^9, 3.799414405149848*^9}, {3.7994144519446707`*^9, 
   3.7994144697382545`*^9}, 3.799414506193618*^9, {3.799414539641938*^9, 
   3.7994145492787776`*^9}, 3.799414592627328*^9, 3.799414888366138*^9, 
   3.7994150348383985`*^9, 3.799415098945119*^9, {3.7994151708356185`*^9, 
   3.7994152135663123`*^9}, 3.799415252276375*^9, {3.799415310929495*^9, 
   3.7994153401323776`*^9}, {3.7994154248511086`*^9, 
   3.7994154938633375`*^9}, {3.7994155582170024`*^9, 
   3.7994155709516926`*^9}, {3.799415604861218*^9, 3.7994156199489813`*^9}, 
   3.7994281040456*^9, 3.7994321434707117`*^9},
 CellLabel->
  "Out[2359]=",ExpressionUUID->"812d3bac-d1c2-4f19-8dd9-ea3e4eeeee38"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.7994128591089506`*^9, {3.799412914114109*^9, 3.7994129628748245`*^9}, 
   3.799413223702812*^9, {3.7994133180529337`*^9, 3.7994133820917816`*^9}, {
   3.799413573816606*^9, 3.7994135806002965`*^9}, 3.79941362699641*^9, 
   3.7994136736353264`*^9, 3.7994138642095256`*^9, {3.799413920671749*^9, 
   3.7994139439001207`*^9}, {3.799414046731799*^9, 3.7994140566394463`*^9}, {
   3.799414107385496*^9, 3.7994141293370514`*^9}, 3.7994143606968083`*^9, {
   3.7994143996613684`*^9, 3.799414405149848*^9}, {3.7994144519446707`*^9, 
   3.7994144697382545`*^9}, 3.799414506193618*^9, {3.799414539641938*^9, 
   3.7994145492787776`*^9}, 3.799414592627328*^9, 3.799414888366138*^9, 
   3.7994150348383985`*^9, 3.799415098945119*^9, {3.7994151708356185`*^9, 
   3.7994152135663123`*^9}, 3.799415252276375*^9, {3.799415310929495*^9, 
   3.7994153401323776`*^9}, {3.7994154248511086`*^9, 
   3.7994154938633375`*^9}, {3.7994155582170024`*^9, 
   3.7994155709516926`*^9}, {3.799415604861218*^9, 3.7994156199489813`*^9}, 
   3.7994281040456*^9, 3.7994321434707117`*^9},
 CellLabel->
  "Out[2360]=",ExpressionUUID->"8e671a48-bd43-464b-b19f-102c58dfee15"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.7994128591089506`*^9, {3.799412914114109*^9, 3.7994129628748245`*^9}, 
   3.799413223702812*^9, {3.7994133180529337`*^9, 3.7994133820917816`*^9}, {
   3.799413573816606*^9, 3.7994135806002965`*^9}, 3.79941362699641*^9, 
   3.7994136736353264`*^9, 3.7994138642095256`*^9, {3.799413920671749*^9, 
   3.7994139439001207`*^9}, {3.799414046731799*^9, 3.7994140566394463`*^9}, {
   3.799414107385496*^9, 3.7994141293370514`*^9}, 3.7994143606968083`*^9, {
   3.7994143996613684`*^9, 3.799414405149848*^9}, {3.7994144519446707`*^9, 
   3.7994144697382545`*^9}, 3.799414506193618*^9, {3.799414539641938*^9, 
   3.7994145492787776`*^9}, 3.799414592627328*^9, 3.799414888366138*^9, 
   3.7994150348383985`*^9, 3.799415098945119*^9, {3.7994151708356185`*^9, 
   3.7994152135663123`*^9}, 3.799415252276375*^9, {3.799415310929495*^9, 
   3.7994153401323776`*^9}, {3.7994154248511086`*^9, 
   3.7994154938633375`*^9}, {3.7994155582170024`*^9, 
   3.7994155709516926`*^9}, {3.799415604861218*^9, 3.7994156199489813`*^9}, 
   3.7994281040456*^9, 3.7994321434707117`*^9},
 CellLabel->
  "Out[2363]=",ExpressionUUID->"4874771a-3e9c-4821-a55f-36507072f7ef"]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>2.4 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (2018\:5e743\:670828\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1685, 47, 754, "Input",ExpressionUUID->"ccc0459f-bd19-4de9-b159-6c9df19899a0"],
Cell[2268, 71, 1231, 18, 108, "Output",ExpressionUUID->"8dfe318b-050e-434a-a930-f64030e6cdbd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3536, 94, 2351, 71, 1054, "Input",ExpressionUUID->"a4eacfae-18cb-4f24-b339-afa419c95482"],
Cell[5890, 167, 1877, 39, 159, "Output",ExpressionUUID->"8dfd3343-d444-42a8-9d28-486643d19c3f"],
Cell[7770, 208, 2086, 45, 161, "Output",ExpressionUUID->"ae586f66-88dd-4f90-82da-da21debb2c17"],
Cell[9859, 255, 1875, 39, 159, "Output",ExpressionUUID->"3649e641-c116-4763-a945-7f274cb5496b"],
Cell[11737, 296, 2946, 69, 211, "Output",ExpressionUUID->"1988fcab-b643-46ed-a117-f627abd2dc3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14720, 370, 4232, 105, 1043, "Input",ExpressionUUID->"992fb974-e434-45d5-a462-bf28b7fc4f94"],
Cell[18955, 477, 1873, 38, 155, "Output",ExpressionUUID->"812d3bac-d1c2-4f19-8dd9-ea3e4eeeee38"],
Cell[20831, 517, 1190, 18, 108, "Output",ExpressionUUID->"8e671a48-bd43-464b-b19f-102c58dfee15"],
Cell[22024, 537, 1190, 18, 140, "Output",ExpressionUUID->"4874771a-3e9c-4821-a55f-36507072f7ef"]
}, Open  ]]
}
]
*)

